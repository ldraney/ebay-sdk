<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ebay-sdk Architecture</title>
    <style>
        body { font-family: system-ui, sans-serif; max-width: 800px; margin: 2rem auto; padding: 0 1rem; line-height: 1.6; color: #333; }
        h1 { border-bottom: 2px solid #0654ba; padding-bottom: 0.5rem; }
        h2 { color: #0654ba; }
        .layer { background: #f5f7fa; border-left: 4px solid #0654ba; padding: 1rem; margin: 1rem 0; }
        .layer h3 { margin-top: 0; }
        code { background: #e8eef5; padding: 0.15em 0.4em; border-radius: 3px; font-size: 0.9em; }
        pre { background: #1e1e1e; color: #d4d4d4; padding: 1rem; border-radius: 6px; overflow-x: auto; }
        table { border-collapse: collapse; width: 100%; margin: 1rem 0; }
        th, td { border: 1px solid #ddd; padding: 0.5rem; text-align: left; }
        th { background: #0654ba; color: white; }
    </style>
</head>
<body>

<h1>ebay-sdk Architecture</h1>

<h2>Layered Design</h2>
<p>The system is built in three layers, each with a clear responsibility:</p>

<div class="layer">
    <h3>Layer 1: eBay OpenAPI Specs (Source of Truth)</h3>
    <p>Every API module in this SDK is built directly from eBay's official OpenAPI 3.0 JSON specs hosted at
    <code>developer.ebay.com/api-docs/master/...</code>. The specs define all paths, parameters, request/response schemas.</p>
</div>

<div class="layer">
    <h3>Layer 2: ldraney-ebay-sdk (This Package)</h3>
    <p>A thin, typed Python wrapper. Each eBay REST API gets its own module. The base <code>EbayClient</code> handles auth
    (via <code>ldraney-ebay-oauth</code>) and HTTP (via <code>httpx</code>). Sub-API classes are accessed as properties on the client.</p>
</div>

<div class="layer">
    <h3>Layer 3: MCP Server (Future)</h3>
    <p>A Model Context Protocol server that wraps <code>ldraney-ebay-sdk</code> as tools. The MCP layer adds no business logic —
    it simply exposes SDK methods as MCP tools with schema validation.</p>
</div>

<h2>API Coverage</h2>
<table>
    <tr><th>API</th><th>Module</th><th>Endpoints</th><th>Spec Version</th></tr>
    <tr><td>Buy Browse</td><td><code>buy.browse</code></td><td>3+</td><td>v1.20.4</td></tr>
    <tr><td>Sell Inventory</td><td><code>sell.inventory</code></td><td>5+</td><td>v1.18.4</td></tr>
    <tr><td>Sell Fulfillment</td><td><code>sell.fulfillment</code></td><td>14</td><td>v1.20.7</td></tr>
    <tr><td>Sell Account</td><td><code>sell.account</code></td><td>15+</td><td>v1.9.3</td></tr>
    <tr><td>Sell Finances</td><td><code>sell.finances</code></td><td>8</td><td>v1.18.0</td></tr>
    <tr><td>Sell Marketing</td><td><code>sell.marketing</code></td><td>many</td><td>v1.22.2</td></tr>
    <tr><td>Sell Feed</td><td><code>sell.feed</code></td><td>10+</td><td>v1.3.1</td></tr>
    <tr><td>Commerce Taxonomy</td><td><code>commerce.taxonomy</code></td><td>9</td><td>v1.1.1</td></tr>
</table>

<h2>Auth Flow</h2>
<pre>
EbayOAuthClient (ldraney-ebay-oauth)
    │
    ├── Client Credentials Grant → Application tokens
    └── Authorization Code Grant → User tokens
         │
         ▼
EbayClient._headers()  →  "Authorization: Bearer {token}"
         │
         ▼
httpx.Client.request()  →  eBay REST API
</pre>

<h2>Key Decisions</h2>
<ul>
    <li><strong>Thin wrappers, not generated code</strong> — hand-written for readability and maintainability.</li>
    <li><strong>Lazy sub-API loading</strong> — <code>ebay.sell_inventory</code> only imports the module when accessed.</li>
    <li><strong>Integration tests only</strong> — no mocks. Every test hits the real eBay sandbox.</li>
    <li><strong>httpx over requests</strong> — modern, async-ready, HTTP/2 capable.</li>
</ul>

</body>
</html>
